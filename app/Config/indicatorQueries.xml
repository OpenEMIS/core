<indicators>
	<indicator id="1">
		<subgroups>
			<item name="All Ages" type="Age" order="1" reference="CensusStudent">
				<mysql>
					<where>
					<![CDATA[
						AND `census_students`.`age` = {KEY}
					]]>
					</where>
				</mysql>
			</item>
			<item name="All Sex" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
						IFNULL((SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)), 'No Data') AS `data_value`,
	(SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)) AS `numerator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Male" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
						IFNULL((SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`numerator`, 0)), 'No Data') AS `data_value`,
	(SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`numerator`, 0)) AS `numerator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Female" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
						IFNULL((SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)), 'No Data') AS `data_value`,
	(SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)) AS `numerator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
				<mysql>
					<where>
					<![CDATA[
							AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
					</where>
				</mysql>		
			</item>
			<item name="All Grades" type="Grade" order="4" reference="EducationGrade">
				<mysql>
					<where>
					<![CDATA[
							AND `education_grades`.`id` = {KEY}
						]]>
					</where>
				</mysql>
			</item>
		
		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        -- {SELECT}
                        NULL AS `denominator`,
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `education_level_isced`.`name` AS `classification`,
                                `census_students`.`age`,
                                `school_years`.`start_year` AS `year`,
                                SUM(`census_students`.`male`) AS `male`,
                                SUM(`census_students`.`female`) AS `female`,
                                SUM(`census_students`.`male`) + SUM(`census_students`.`female`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_grades` ON `education_grades`.`education_programme_id` = `institution_site_programmes`.`education_programme_id`
                            JOIN `education_programmes` ON `education_programmes`.`id` = `education_grades`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            JOIN `education_levels` ON `education_levels`.`id` = `education_cycles`.`education_level_id`
                            JOIN `education_level_isced` ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                            JOIN `census_students`
                                ON `census_students`.`education_grade_id` = `education_grades`.`id`
                                AND `census_students`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `school_years` ON `school_years`.`id` = `census_students`.`school_year_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}

                            GROUP BY
                            -- {GROUP}
                            `areas`.`id`,
                            `census_students`.`age`,
                            `census_students`.`school_year_id`,
                            `census_students`.`education_grade_id`
                        ) AS `main_data`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `main_data`.`classification`
				]]>
				</insert>
			</mysql>
		</query>
		
	</indicator>
	<indicator id="2">
		<subgroups>
			<item name="All Sex" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
						IFNULL((SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)), 'No Data') AS `data_value`,
IFNULL((SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)), 0) AS `numerator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Male" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
						IFNULL((SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`numerator`, 0)), 'No Data') AS `data_value`,
IFNULL((SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`numerator`, 0)), 0) AS `numerator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Female" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
						IFNULL((SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)), 'No Data') AS `data_value`,
IFNULL((SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)), 0) AS `numerator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
				<mysql>
					<where>
					<![CDATA[
							AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
					</where>
				</mysql>
			</item>
			<item name="All Grades" type="Grade" order="4" reference="EducationGrade">
				<mysql>
					<where>
					<![CDATA[
							AND `education_grades`.`id` = {KEY}
						]]>
					</where>
				</mysql>
			</item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        -- {SELECT}
                        NULL AS `denominator`,
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                CONCAT('Teachers - ', `education_level_isced`.`name`) AS `classification`,
                                `school_years`.`start_year` AS `year`,
                                SUM(`census_teachers`.`male`) AS `male`,
                                SUM(`census_teachers`.`female`) AS `female`,
                                SUM(`census_teachers`.`male`) + SUM(`census_teachers`.`female`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_grades` ON `education_grades`.`education_programme_id` = `institution_site_programmes`.`education_programme_id`
                            JOIN `education_programmes` ON `education_programmes`.`id` = `education_grades`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            JOIN `education_levels` ON `education_levels`.`id` = `education_cycles`.`education_level_id`
                            JOIN `education_level_isced` ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                            JOIN `census_teachers`
                                ON `census_teachers`.`institution_site_id` = `institution_sites`.`id`
--                                AND `census_teachers`.`education_grade_id` = `education_grades`.`id`
                            JOIN `school_years` ON `school_years`.`id` = `census_teachers`.`school_year_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}

                            GROUP BY
                            -- {GROUP}
                            `areas`.`id`,
                            `census_teachers`.`school_year_id`
--                            `census_teachers`.`education_grade_id`
                        ) AS `main_data`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `main_data`.`classification`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="3">
		<subgroups>
			<item name="All Sex" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
						IFNULL((SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)), 'No Data') AS `data_value`,
IFNULL((SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)), 0) AS `numerator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Male" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
						IFNULL((SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`numerator`, 0)), 'No Data') AS `data_value`,
IFNULL((SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`numerator`, 0)), 0) AS `numerator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Female" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
						IFNULL((SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)), 'No Data') AS `data_value`,
IFNULL((SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)), 0) AS `numerator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
				<mysql>
					<where>
					<![CDATA[
							AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
					</where>
				</mysql>
			</item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        -- {SELECT}
                        NULL AS `denominator`,
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                CONCAT('Staff - ', `staff_categories`.`name`) AS `classification`,
                                `school_years`.`start_year` AS `year`,
                                SUM(`census_staff`.`male`) AS `male`,
                                SUM(`census_staff`.`female`) AS `female`,
                                SUM(`census_staff`.`male`) + SUM(`census_staff`.`female`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `census_staff` ON `census_staff`.`institution_site_id` = `institution_sites`.`id`
                               JOIN `staff_categories` ON `staff_categories`.`id` = `census_staff`.`staff_category_id`
                           	JOIN `school_years` ON `school_years`.`id` = `census_staff`.`school_year_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}

                            GROUP BY
                            -- {GROUP}
                            `areas`.`id`,
                            `census_staff`.`school_year_id`,
                            `census_staff`.`staff_category_id`
                        ) AS `main_data`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `main_data`.`classification`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="4">
		<subgroups>
			<item name="All Sectors" type="Sector" order="5" reference="InstitutionSector">
				<mysql>
					<where>
					<![CDATA[
							AND `institutions`.`institution_sector_id` = {KEY}
						]]>
					</where>
				</mysql>
			</item>
			<item name="All Providers" type="Provider" order="8" reference="InstitutionProvider">
				<mysql>
					<where>
					<![CDATA[
							AND `institutions`.`institution_provider_id` = {KEY}
						]]>
					</where>
				</mysql>
			</item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        IFNULL((SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)), 'No Data') AS `data_value`,
                        (SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)) AS `numerator`,
                        NULL AS `denominator`,
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                CONCAT('Institutions - ', `institution_statuses`.`name`) AS `classification`,
                                YEAR(`institutions`.`date_opened`) AS `year`,
                                COUNT(`institutions`.`id`) AS `total`
                            FROM `areas`
                            JOIN `institutions` ON `institutions`.`area_id` = `areas`.`id`
                            	JOIN `institution_sectors` ON `institution_sectors`.`id` = `institutions`.`institution_sector_id`
                            	JOIN `institution_providers` ON `institution_providers`.`id` = `institutions`.`institution_provider_id`
                            	JOIN `institution_statuses` ON `institution_statuses`.`id` = `institutions`.`institution_status_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}

                            GROUP BY
                            -- {GROUP}
                            `areas`.`id`,
                            `institutions`.`institution_status_id`,
                            YEAR(`institutions`.`date_opened`)
                        ) AS `main_data`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `main_data`.`classification`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="5">
		<subgroups>
			<item name="All Localities" type="locality" order="3" reference="InstitutionSiteLocality">
				<mysql>
					<where>
					<![CDATA[
							AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
					</where>
				</mysql>
			</item>
			<item name="All Types" type="Type" order="9" reference="InstitutionSiteType">
				<mysql>
					<where>
					<![CDATA[
							AND `institution_sites`.`institution_site_type_id` = {KEY}
						]]>
					</where>
				</mysql>
			</item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        IFNULL((SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)), 'No Data') AS `data_value`,
                        (SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)) AS `numerator`,
                        NULL AS `denominator`,
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                CONCAT('Institution Sites - ', `institution_site_statuses`.`name`) AS `classification`,
                                YEAR(`institution_sites`.`date_opened`) AS `year`,
                                COUNT(`institution_sites`.`id`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            	JOIN `institution_site_types` ON `institution_site_types`.`id` = `institution_sites`.`institution_site_type_id`
                            	JOIN `institution_site_localities` ON `institution_site_localities`.`id` = `institution_sites`.`institution_site_locality_id`
                            	JOIN `institution_site_statuses` ON `institution_site_statuses`.`id` = `institution_sites`.`institution_site_status_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}

                            GROUP BY
                            -- {GROUP}
                            `areas`.`id`,
                            `institution_sites`.`institution_site_status_id`,
                            YEAR(`institution_sites`.`date_opened`)
                        ) AS `main_data`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `main_data`.`classification`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="6">
		<subgroups>
            <item name="All Ages" type="Age" order="1" reference="Population">
                <mysql>
                    <where>
                        <![CDATA[
						AND `population`.`age` = {KEY}
					]]>
                    </where>
                </mysql>
            </item>
            <item name="All Sex" type="Sex" order="2">
                <mysql>
                    <select>
                        <![CDATA[
						IFNULL((SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)), 'No Data') AS `data_value`,
IFNULL((SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)), 0) AS `numerator`,
					]]>
                    </select>
                </mysql>
            </item>
            <item name="Male" type="Sex" order="2">
                <mysql>
                    <select>
                        <![CDATA[
						IFNULL((SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`numerator`, 0)), 'No Data') AS `data_value`,
IFNULL((SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`numerator`, 0)), 0) AS `numerator`,
					]]>
                    </select>
                </mysql>
            </item>
            <item name="Female" type="Sex" order="2">
                <mysql>
                    <select>
                        <![CDATA[
						IFNULL((SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)), 'No Data') AS `data_value`,
IFNULL((SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)), 0) AS `numerator`,
					]]>
                    </select>
                </mysql>
            </item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        -- {SELECT}
                        NULL AS `denominator`,
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                CONCAT('Population - ', `population`.`source`) AS `classification`,
                                `population`.`age`,
                                `population`.`year`,
                                SUM(`population`.`male`) AS `male`,
                                SUM(`population`.`female`) AS `female`,
                                SUM(`population`.`male`) + SUM(`population`.`female`) AS `total`
                            FROM `areas`
                            JOIN `population` ON `population`.`area_id` = `areas`.`id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}

                            GROUP BY
                            -- {GROUP}
                            `areas`.`id`,
                            `population`.`age`,
                            `population`.`year`
                        ) AS `main_data`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `main_data`.`classification`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="7">
		<subgroups>
			<item name="All Sex" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
						IFNULL(((SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`population`.`male` + `population`.`female`) + IFNULL(`indicator_results`.`denominator`, 0))) * 100, 'No Data') AS `data_value`,
(SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)) AS `numerator`,
(SUM(`population`.`male` + `population`.`female`) + IFNULL(`indicator_results`.`denominator`, 0)) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Male" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
						IFNULL(((SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`population`.`male`) + IFNULL(`indicator_results`.`denominator`, 0))) * 100, 'No Data') AS `data_value`,
(SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`numerator`, 0)) AS `numerator`,
(SUM(`population`.`male`) + IFNULL(`indicator_results`.`denominator`, 0)) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Female" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
						IFNULL(((SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`population`.`female`) + IFNULL(`indicator_results`.`denominator`, 0))) * 100, 'No Data') AS `data_value`,
(SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)) AS `numerator`,
(SUM(`population`.`female`) + IFNULL(`indicator_results`.`denominator`, 0)) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
				<mysql>
					<where>
					<![CDATA[
							AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
					</where>
				</mysql>
			</item>
			<item name="All Grades" type="Grade" order="4" reference="EducationGrade">
				<mysql>
					<where>
					<![CDATA[
							AND `education_grades`.`id` = {KEY}
						]]>
					</where>
				</mysql>
			</item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        -- {SELECT}
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `education_level_isced`.`name` AS `classification`,
                                `census_students`.`age`,
                                `school_years`.`start_year` AS `year`,
                                SUM(`census_students`.`male`) AS `male`,
                                SUM(`census_students`.`female`) AS `female`,
                                SUM(`census_students`.`male`) + SUM(`census_students`.`female`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_grades` ON `education_grades`.`education_programme_id` = `institution_site_programmes`.`education_programme_id`
                            JOIN (
                                SELECT
                                `edu_grades`.`id` AS `education_grade_id`,
                                `edu_grades`.`name` AS `education_grade_name`,
                                `education_cycles`.`education_level_id` AS `education_level_id`,
                                `education_programmes`.`name` AS `education_programme_name`,
                                IF(
                                    `edu_grades`.`order` = 1,
                                    @curRow := `education_cycles`.`admission_age`,
                                    @curRow := @curRow + 1
                                ) AS `official_age`
                                FROM (
                                    SELECT `id`, `name`, `education_programme_id`, `order`
                                    FROM `education_grades`
                                    ORDER BY `education_programme_id`, `order`
                                ) AS `edu_grades`
                                JOIN `education_programmes` ON `education_programmes`.`id` = `edu_grades`.`education_programme_id`
                                JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            ) AS `grades`
                                ON `grades`.`education_grade_id` = `education_grades`.`id`
                            JOIN `education_levels` ON `education_levels`.`id` = `grades`.`education_level_id`
                            JOIN `education_level_isced` ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                            JOIN `census_students`
                                ON `census_students`.`education_grade_id` = `education_grades`.`id`
                                AND `census_students`.`institution_site_id` = `institution_sites`.`id`
                                AND `census_students`.`age` = `grades`.`official_age`
                                AND `census_students`.`student_category_id` IN (1,2) -- NEW OR PROMOTED
                            JOIN `school_years` ON `school_years`.`id` = `census_students`.`school_year_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY
                            `areas`.`id`,
                            `census_students`.`school_year_id`,
                            `census_students`.`education_grade_id`
                        ) AS `main_data`

                        JOIN `population`
                            ON `population`.`age` = `main_data`.`age`
                            AND `population`.`year` = `main_data`.`year`
                            AND `population`.`area_id` = `main_data`.`area_id`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `main_data`.`classification`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="8">
		<subgroups>
			<item name="All Sex" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            IFNULL(((SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`population`.`male` + `population`.`female`) + IFNULL(`indicator_results`.`denominator`, 0))) * 100, 'No Data') AS `data_value`,
(SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)) AS `numerator`,
(SUM(`population`.`male` + `population`.`female`) + IFNULL(`indicator_results`.`denominator`, 0)) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Male" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            IFNULL(((SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`population`.`male`) + IFNULL(`indicator_results`.`denominator`, 0))) * 100, 'No Data') AS `data_value`,
(SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`numerator`, 0)) AS `numerator`,
(SUM(`population`.`male`) + IFNULL(`indicator_results`.`denominator`, 0)) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Female" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            IFNULL(((SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`population`.`female`) + IFNULL(`indicator_results`.`denominator`, 0))) * 100, 'No Data') AS `data_value`,
(SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)) AS `numerator`,
(SUM(`population`.`female`) + IFNULL(`indicator_results`.`denominator`, 0)) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
				<mysql>
					<where>
					<![CDATA[
                            AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
					</where>
				</mysql>
			</item>
			<item name="All Grades" type="Grade" order="4" reference="EducationGrade">
				<mysql>
					<where>
					<![CDATA[
                            AND `education_grades`.`id` = {KEY}
						]]>
					</where>
				</mysql>
			</item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                    INSERT INTO `batch_indicator_results`
                    SELECT
                    NULL,
                    -- {INDICATOR_ID} AS `batch_indicator_id`,
                    -- {SUBGROUPS} AS `subgroups`,
                    `main_data`.`area_id`,
                    `main_data`.`year` AS `timeperiod`,
                    -- {SELECT}
                    `main_data`.`classification`,
                    -- {USER_ID},
                    NOW()

                    FROM (
                        SELECT
                            `areas`.`id` AS `area_id`,
                            `education_level_isced`.`name` AS `classification`,
                            `grades`.`official_age` AS `age`,
                            `school_years`.`start_year` AS `year`,
                            SUM(`census_students`.`male`) AS `male`,
                            SUM(`census_students`.`female`) AS `female`,
                            SUM(`census_students`.`male`) + SUM(`census_students`.`female`) AS `total`
                        FROM `areas`
                        JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                        JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                        JOIN `education_grades` ON `education_grades`.`education_programme_id` = `institution_site_programmes`.`education_programme_id`
                        JOIN (
                            SELECT
                            `edu_grades`.`id` AS `education_grade_id`,
                            `edu_grades`.`name` AS `education_grade_name`,
                            `education_cycles`.`education_level_id` AS `education_level_id`,
                            `education_programmes`.`name` AS `education_programme_name`,
                            IF(
                                `edu_grades`.`order` = 1,
                                @curRow := `education_cycles`.`admission_age`,
                                @curRow := @curRow + 1
                            ) AS `official_age`
                            FROM (
                                SELECT `id`, `name`, `education_programme_id`, `order`
                                FROM `education_grades`
                                ORDER BY `education_programme_id`, `order`
                            ) AS `edu_grades`
                            JOIN `education_programmes` ON `education_programmes`.`id` = `edu_grades`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                        ) AS `grades`
                            ON `grades`.`education_grade_id` = `education_grades`.`id`
                        JOIN `education_levels` ON `education_levels`.`id` = `grades`.`education_level_id`
                        JOIN `education_level_isced` ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                        JOIN `census_students`
                            ON `census_students`.`education_grade_id` = `education_grades`.`id`
                            AND `census_students`.`institution_site_id` = `institution_sites`.`id`
                            AND `census_students`.`student_category_id` IN (1,2) -- NEW OR PROMOTED
                        JOIN `school_years` ON `school_years`.`id` = `census_students`.`school_year_id`
                        WHERE `areas`.`area_level_id` = -- {LEVEL}
                        -- {WHERE}
                        GROUP BY
                        `areas`.`id`,
                        `census_students`.`school_year_id`,
                        `census_students`.`education_grade_id`
                    ) AS `main_data`

                    JOIN `population`
                        ON `population`.`age` = `main_data`.`age`
                        AND `population`.`year` = `main_data`.`year`
                        AND `population`.`area_id` = `main_data`.`area_id`

                    -- Aggregation by Area Start
                    LEFT JOIN (
                        SELECT
                        `areas`.`parent_id` AS `area_parent_id`,
                        `batch_indicator_results`.`timeperiod`,
                        SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                        SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                        `batch_indicator_results`.`classification`
                        FROM `batch_indicator_results`
                        JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                        WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                        AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                        GROUP BY
                        `areas`.`parent_id`,
                        `batch_indicator_results`.`timeperiod`,
                        `batch_indicator_results`.`classification`
                    ) AS `indicator_results`
                        ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                        AND `indicator_results`.`timeperiod` = `main_data`.`year`
                        AND `indicator_results`.`classification` = `main_data`.`classification`
                    -- Aggregation by Area End

                    GROUP BY
                    `main_data`.`year`,
                    `main_data`.`area_id`,
                    `main_data`.`classification`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="9">
		<subgroups>
			<item name="All Sex" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            IFNULL(((SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`population`.`male` + `population`.`female`) + IFNULL(`indicator_results`.`denominator`, 0))) * 100, 'No Data') AS `data_value`,
(SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)) AS `numerator`,
(SUM(`population`.`male` + `population`.`female`) + IFNULL(`indicator_results`.`denominator`, 0)) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Male" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            IFNULL(((SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`population`.`male`) + IFNULL(`indicator_results`.`denominator`, 0))) * 100, 'No Data') AS `data_value`,
(SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`numerator`, 0)) AS `numerator`,
(SUM(`population`.`male`) + IFNULL(`indicator_results`.`denominator`, 0)) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Female" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            IFNULL(((SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`population`.`female`) + IFNULL(`indicator_results`.`denominator`, 0))) * 100, 'No Data') AS `data_value`,
(SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)) AS `numerator`,
(SUM(`population`.`female`) + IFNULL(`indicator_results`.`denominator`, 0)) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
            <item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
                <mysql>
                    <where>
                        <![CDATA[
                            AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        -- {SELECT}
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `education_level_isced`.`name` AS `classification`,
                                `census_students`.`age`,
                                `school_years`.`start_year` AS `year`,
                                SUM(`census_students`.`male`) AS `male`,
                                SUM(`census_students`.`female`) AS `female`,
                                SUM(`census_students`.`male`) + SUM(`census_students`.`female`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_grades`
                                ON `education_grades`.`education_programme_id` = `institution_site_programmes`.`education_programme_id`
                                AND `education_grades`.`order` = 1 -- FIRST GRADE
                            JOIN `education_programmes` ON `education_programmes`.`id` = `education_grades`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            JOIN `education_levels` ON `education_levels`.`id` = `education_cycles`.`education_level_id`
                            JOIN `education_level_isced`
                                ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                                AND `education_level_isced`.`isced_level` = 1 -- PRIMARY
                                AND `education_level_isced`.`visible` = 1
                            JOIN `census_students`
                                ON `census_students`.`education_grade_id` = `education_grades`.`id`
                                AND `census_students`.`institution_site_id` = `institution_sites`.`id`
                                AND `census_students`.`age` = `education_cycles`.`admission_age`
                                AND `census_students`.`student_category_id` = 1 -- NEW ENROLMENT
                            JOIN `school_years` ON `school_years`.`id` = `census_students`.`school_year_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY
                            `areas`.`id`,
                            `census_students`.`school_year_id`,
                            `census_students`.`education_grade_id`
                        ) AS `main_data`

                        JOIN `population`
                            ON `population`.`age` = `main_data`.`age`
                            AND `population`.`year` = `main_data`.`year`
                            AND `population`.`area_id` = `main_data`.`area_id`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `main_data`.`classification`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="10">
		<subgroups>
			<item name="All Sex" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            IFNULL(((SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`population`.`male` + `population`.`female`) + IFNULL(`indicator_results`.`denominator`, 0))) * 100, 'No Data') AS `data_value`,
(SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)) AS `numerator`,
(SUM(`population`.`male` + `population`.`female`) + IFNULL(`indicator_results`.`denominator`, 0)) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Male" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            IFNULL(((SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`population`.`male`) + IFNULL(`indicator_results`.`denominator`, 0))) * 100, 'No Data') AS `data_value`,
(SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`numerator`, 0)) AS `numerator`,
(SUM(`population`.`male`) + IFNULL(`indicator_results`.`denominator`, 0)) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Female" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            IFNULL(((SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`population`.`female`) + IFNULL(`indicator_results`.`denominator`, 0))) * 100, 'No Data') AS `data_value`,
(SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)) AS `numerator`,
(SUM(`population`.`female`) + IFNULL(`indicator_results`.`denominator`, 0)) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
            <item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
                <mysql>
                    <where>
                        <![CDATA[
                            AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        -- {SELECT}
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `education_level_isced`.`name` AS `classification`,
                                `census_students`.`age`,
                                `school_years`.`start_year` AS `year`,
                                SUM(`census_students`.`male`) AS `male`,
                                SUM(`census_students`.`female`) AS `female`,
                                SUM(`census_students`.`male`) + SUM(`census_students`.`female`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_grades`
                                ON `education_grades`.`education_programme_id` = `institution_site_programmes`.`education_programme_id`
                                AND `education_grades`.`order` = 1 -- FIRST GRADE
                            JOIN `education_programmes` ON `education_programmes`.`id` = `education_grades`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            JOIN `education_levels` ON `education_levels`.`id` = `education_cycles`.`education_level_id`
                            JOIN `education_level_isced`
                                ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                                AND `education_level_isced`.`isced_level` = 1 -- PRIMARY
                                AND `education_level_isced`.`visible` = 1
                            JOIN `census_students`
                                ON `census_students`.`education_grade_id` = `education_grades`.`id`
                                AND `census_students`.`institution_site_id` = `institution_sites`.`id`
                                AND `census_students`.`student_category_id` = 1 -- NEW ENROLMENT
                            JOIN `school_years` ON `school_years`.`id` = `census_students`.`school_year_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY
                            `areas`.`id`,
                            `census_students`.`school_year_id`,
                            `census_students`.`education_grade_id`
                        ) AS `main_data`

                        JOIN `population`
                            ON `population`.`age` = `main_data`.`age`
                            AND `population`.`year` = `main_data`.`year`
                            AND `population`.`area_id` = `main_data`.`area_id`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `main_data`.`classification`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="11">
		<subgroups>
			<item name="All Sex" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            (SUM(`census_students`.`male`) + SUM(`census_students`.`female`)) / `main_data`.`total` * 100 AS `data_value`,
SUM(`census_students`.`male`) + SUM(`census_students`.`female`) AS `numerator`,
`main_data`.`total` AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Male" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            SUM(`census_students`.`male`) / `main_data`.`male` * 100 AS `data_value`,
SUM(`census_students`.`male`) AS `numerator`,
`main_data`.`male` AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Female" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            SUM(`census_students`.`female`) / `main_data`.`female` * 100 AS `data_value`,
SUM(`census_students`.`female`) AS `numerator`,
`main_data`.`female` AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
            <item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
                <mysql>
                    <where>
                        <![CDATA[
                            AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>
            <item name="All Sectors" type="Sector" order="5" reference="InstitutionSector">
                <mysql>
                    <where>
                        <![CDATA[
                            AND `institutions`.`institution_sector_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        -- {SELECT}
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `school_years`.`start_year` AS `year`,
                                `institution_site_programmes`.`id` AS `site_programme_id`,
                                `institution_sites`.`id` AS `institution_site_id`,
                                SUM(`census_students`.`male`) AS `male`,
                                SUM(`census_students`.`female`) AS `female`,
                                SUM(`census_students`.`male`) + SUM(`census_students`.`female`) AS `total`,
                                `year_set_b`.`id` AS `year_id_b`,
                                `grade_set_b`.`id` AS `grade_id_b`,
                                CONCAT(`education_level_isced`.`name`, ' - ', `education_programmes`.`name`, ' - ', `education_grades`.`name`)  AS `classification`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institutions` ON `institutions`.`id` = `institution_sites`.`institution_id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_grades` ON `education_grades`.`education_programme_id` = `institution_site_programmes`.`education_programme_id`
                            JOIN `education_programmes` ON `education_programmes`.`id` = `education_grades`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            JOIN `education_levels` ON `education_levels`.`id` = `education_cycles`.`education_level_id`
                            JOIN `education_level_isced` ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                            JOIN `census_students`
                                ON `census_students`.`education_grade_id` = `education_grades`.`id`
                                AND `census_students`.`institution_site_id` = `institution_sites`.`id`
                                AND `census_students`.`student_category_id` = 1 -- PROMOTED
                            JOIN `school_years` ON `school_years`.`id` = `census_students`.`school_year_id`
                            JOIN `school_years` AS `year_set_b`
                                ON `year_set_b`.`name` = `school_years`.`name` + 1
                            JOIN `education_grades` AS `grade_set_b`
                                ON `grade_set_b`.`education_programme_id` = `institution_site_programmes`.`education_programme_id`
                                AND `grade_set_b`.`order` = `education_grades`.`order` + 1
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY `areas`.`id`, `school_years`.`id`, `census_students`.`education_grade_id`
                        ) AS `main_data`

                        JOIN `census_students`
                            ON `census_students`.`education_grade_id` = `main_data`.`grade_id_b`
                            AND `census_students`.`institution_site_id` = `main_data`.`institution_site_id`
                            AND `census_students`.`school_year_id` = `main_data`.`year_id_b`
                            AND `census_students`.`student_category_id` = 3 -- REPEATED

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `census_students`.`education_grade_id`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="12">
		<subgroups>
			<item name="All Sex" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            (SUM(`main_data`.`male`) + SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)) / (`main_data`.`total` + IFNULL(`indicator_results`.`denominator`, 0)) * 100 AS `data_value`,
SUM(`main_data`.`male`) + SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
`main_data`.`total` + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Male" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            (SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`numerator`, 0)) / (`main_data`.`male` + IFNULL(`indicator_results`.`denominator`, 0)) * 100 AS `data_value`,
SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
`main_data`.`male` + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Female" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            (SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)) / (`main_data`.`female` + IFNULL(`indicator_results`.`denominator`, 0)) * 100 AS `data_value`,
SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
`main_data`.`female` + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
            <item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
                <mysql>
                    <where>
                        <![CDATA[
                            AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>
            <item name="All Sectors" type="Sector" order="5" reference="InstitutionSector">
                <mysql>
                    <where>
                        <![CDATA[
                            AND `institutions`.`institution_sector_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        -- {SELECT}
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                (`education_cycles`.`admission_age` + `education_cycles_max`.`order` - 1) AS `theoretical_age`,
                                `school_years`.`name` AS `year`,
                                `education_level_isced`.`name` AS `classification`,
                                SUM(`census_graduates`.`male`) AS `male`,
                                SUM(`census_graduates`.`female`) AS `female`,
                                SUM(`census_graduates`.`male`) + SUM(`census_graduates`.`female`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                                JOIN `institution_site_localities` ON `institution_site_localities`.`id` = `institution_sites`.`institution_site_locality_id`
                                JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                                JOIN `institutions` ON `institutions`.`id` = `institution_sites`.`institution_id`
                                    JOIN `institution_sectors` ON `institution_sectors`.`id` = `institutions`.`institution_sector_id`
                            JOIN `education_programmes`
                                ON `education_programmes`.`id` = `institution_site_programmes`.`education_programme_id`
                                AND `education_programmes`.`visible` = 1
                            JOIN `education_cycles`
                                ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                                AND `education_cycles`.`visible` = 1
                            JOIN (
                                SELECT
                                `education_cycles`.`education_level_id`,
                                MAX(`education_cycles`.`order`) AS `order`
                                FROM `education_cycles`
                                WHERE `education_cycles`.`visible` = 1
                                GROUP BY `education_cycles`.`education_level_id`
                            ) AS `education_cycles_max`
                                ON `education_cycles_max`.`education_level_id` = `education_cycles`.`education_level_id`
                                AND `education_cycles_max`.`order` = `education_cycles`.`order`
                            JOIN `education_levels`
                                ON `education_levels`.`id` = `education_cycles`.`education_level_id`
                                AND `education_levels`.`visible` = 1
                            JOIN `education_level_isced`
                                ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                                AND `education_level_isced`.`visible` = 1
                            JOIN `census_graduates`	ON `census_graduates`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `school_years` ON `school_years`.`id` = `census_graduates`.`school_year_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY
                            -- {GROUP}
                            `school_years`.`id`,
                            `areas`.`id`,
                            `education_levels`.`id`
                        ) AS `main_data`

                        LEFT JOIN `population`
                            ON `population`.`age` = `main_data`.`theoretical_age`
                            AND `population`.`year` = `main_data`.`year`
                            AND `population`.`area_id` = `main_data`.`area_id`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `main_data`.`classification`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="13">
		<subgroups>
			<item name="All Sex" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            (SUM(`census_students`.`male`) + SUM(`census_students`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)) / (`main_data`.`total` + IFNULL(`indicator_results`.`denominator`, 0)) * 100 AS `data_value`,
SUM(`census_students`.`male`) + SUM(`census_students`.`female`) + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
`main_data`.`total` + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Male" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            (SUM(`census_students`.`male`) + IFNULL(`indicator_results`.`numerator`, 0)) / (`main_data`.`male` + IFNULL(`indicator_results`.`denominator`, 0)) * 100 AS `data_value`,
SUM(`census_students`.`male`) + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
`main_data`.`male` + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Female" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            (SUM(`census_students`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)) / (`main_data`.`female` + IFNULL(`indicator_results`.`denominator`, 0)) * 100 AS `data_value`,
SUM(`census_students`.`female`) + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
`main_data`.`female` + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
            <item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
                <mysql>
                    <where>
                        <![CDATA[
                            AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>
            <item name="All Sectors" type="Sector" order="5" reference="InstitutionSector">
                <mysql>
                    <where>
                        <![CDATA[
                            AND `institutions`.`institution_sector_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        -- {SELECT}
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `school_years`.`start_year` AS `year`,
                                `institution_site_programmes`.`id` AS `site_programme_id`,
                                `institution_sites`.`id` AS `institution_site_id`,
                                SUM(`census_students`.`male`) AS `male`,
                                SUM(`census_students`.`female`) AS `female`,
                                SUM(`census_students`.`male`) + SUM(`census_students`.`female`) AS `total`,
                                `year_set_b`.`id` AS `year_id_b`,
                                `grade_set_b`.`id` AS `grade_id_b`,
                                CONCAT(`education_level_isced`.`name`, ' - ', `education_programmes`.`name`, ' - ', `education_grades`.`name`)  AS `classification`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institutions` ON `institutions`.`id` = `institution_sites`.`institution_id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_grades` ON `education_grades`.`education_programme_id` = `institution_site_programmes`.`education_programme_id`
                            JOIN `education_programmes` ON `education_programmes`.`id` = `education_grades`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            JOIN `education_levels` ON `education_levels`.`id` = `education_cycles`.`education_level_id`
                            JOIN `education_level_isced` ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                            JOIN `census_students`
                                ON `census_students`.`education_grade_id` = `education_grades`.`id`
                                AND `census_students`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `school_years` ON `school_years`.`id` = `census_students`.`school_year_id`
                            JOIN `school_years` AS `year_set_b`
                                ON `year_set_b`.`name` = `school_years`.`name` + 1
                            JOIN `education_grades` AS `grade_set_b`
                                ON `grade_set_b`.`education_programme_id` = `institution_site_programmes`.`education_programme_id`
                                AND `grade_set_b`.`order` = `education_grades`.`order` + 1
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY `areas`.`id`, `school_years`.`id`, `census_students`.`education_grade_id`
                        ) AS `main_data`

                        JOIN `census_students`
                            ON `census_students`.`education_grade_id` = `main_data`.`grade_id_b`
                            AND `census_students`.`institution_site_id` = `main_data`.`institution_site_id`
                            AND `census_students`.`school_year_id` = `main_data`.`year_id_b`
                            AND `census_students`.`student_category_id` IN (1,2)

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `census_students`.`education_grade_id`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="14">
		<subgroups>
			<item name="All Sex" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            (`main_data`.`total` + IFNULL(`indicator_results`.`numerator`, 0)) / (`main_data_b`.`total` + IFNULL(`indicator_results`.`denominator`, 0)) * 100 AS `data_value`,
`main_data`.`total` + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
`main_data_b`.`total` + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Male" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            (`main_data`.`male` + IFNULL(`indicator_results`.`numerator`, 0)) / (`main_data_b`.`male` + IFNULL(`indicator_results`.`denominator`, 0)) * 100 AS `data_value`,
`main_data`.`male` + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
`main_data_b`.`male` + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Female" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            (`main_data`.`female` + IFNULL(`indicator_results`.`numerator`, 0)) / (`main_data_b`.`female` + IFNULL(`indicator_results`.`denominator`, 0)) * 100 AS `data_value`,
`main_data`.`female` + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
`main_data_b`.`female` + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
            <item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
                <mysql>
                    <where>
                        <![CDATA[
                            AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>
            <item name="All Sectors" type="Sector" order="5" reference="InstitutionSector">
                <mysql>
                    <where>
                        <![CDATA[
                            AND `institutions`.`institution_sector_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        -- {SELECT}
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `school_years`.`start_year` AS `year`,
                                `education_cycles`.`education_level_id`,
                                `education_cycles`.`order` AS `education_cycle_order`,
                                SUM(`census_students`.`male`) AS `male`,
                                SUM(`census_students`.`female`) AS `female`,
                                SUM(`census_students`.`male`) + SUM(`census_students`.`female`) AS `total`,
                                CONCAT(`education_level_isced`.`name`, ' - ', `education_cycles`.`name`) AS `classification`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institutions` ON `institutions`.`id` = `institution_sites`.`institution_id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_grades`
                                ON `education_grades`.`education_programme_id` = `institution_site_programmes`.`education_programme_id`
                                AND `education_grades`.`order` = 1
                            JOIN `education_programmes` ON `education_programmes`.`id` = `education_grades`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            JOIN `education_levels` ON `education_levels`.`id` = `education_cycles`.`education_level_id`
                            JOIN `education_level_isced` ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                            JOIN `census_students`
                                ON `census_students`.`institution_site_id` = `institution_sites`.`id`
                                AND `census_students`.`education_grade_id` = `education_grades`.`id`
                                AND `census_students`.`student_category_id` = 1 -- PROMOTED
                            JOIN `school_years` ON `school_years`.`id` = `census_students`.`school_year_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY `areas`.`id`, `school_years`.`id`, `education_cycles`.`id`
                        ) AS `main_data`

                        JOIN (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `school_years`.`name` AS `year`,
                                `education_cycles`.`education_level_id`,
                                `education_cycles`.`order` AS `education_cycle_order`,
                                SUM(`census_students`.`male`) AS `male`,
                                SUM(`census_students`.`female`) AS `female`,
                                SUM(`census_students`.`male`) + SUM(`census_students`.`female`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institutions` ON `institutions`.`id` = `institution_sites`.`institution_id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN (
                                SELECT
                                    MAX(`education_grades`.`order`) AS `order`,
                                    `education_grades`.`education_programme_id`
                                FROM `education_grades`
                                WHERE `education_grades`.`visible` = 1
                                GROUP BY `education_programme_id`
                            ) AS `education_grades_final`
                                ON `education_grades_final`.`education_programme_id` = `institution_site_programmes`.`education_programme_id`
                            JOIN `education_grades`
                                ON `education_grades`.`education_programme_id` = `institution_site_programmes`.`education_programme_id`
                                AND `education_grades`.`order` = `education_grades_final`.`order`
                            JOIN `education_programmes` ON `education_programmes`.`id` = `education_grades`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            JOIN `census_students`
                                ON `census_students`.`institution_site_id` = `institution_sites`.`id`
                                AND `census_students`.`education_grade_id` = `education_grades`.`id`
                                AND `census_students`.`student_category_id` = 1 -- PROMOTED
                            JOIN `school_years` ON `school_years`.`id` = `census_students`.`school_year_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY `areas`.`id`, `census_students`.`school_year_id`, `education_cycles`.`id`
                        ) AS `main_data_b`
                            ON `main_data_b`.`year` = `main_data`.`year` - 1
                            AND `main_data_b`.`area_id` = `main_data`.`area_id`
                            AND `main_data_b`.`education_level_id` = `main_data`.`education_level_id`
                            AND `main_data_b`.`education_cycle_order` = `main_data`.`education_cycle_order` - 1

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `main_data`.`education_level_id`
--                        `main_data`.`education_cycle_id`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="15">
		<subgroups>
            <item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>
            <item name="All Sectors" type="Sector" order="5" reference="InstitutionSector">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `institutions`.`institution_sector_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
				        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        (SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`teachers`.`total`) + IFNULL(`indicator_results`.`denominator`, 0)) AS `data_value`,
                        SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
                        SUM(`teachers`.`total`) + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `education_levels`.`id` AS `education_level_id`,
                                `education_level_isced`.`name` AS `classification`,
                                `school_years`.`id` AS `year_id`,
                                `school_years`.`start_year` AS `year`,
                                SUM(`census_students`.`male`) + SUM(`census_students`.`female`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institutions` ON `institutions`.`id` = `institution_sites`.`institution_id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_programmes` ON `education_programmes`.`id` = `institution_site_programmes`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            JOIN `education_levels` ON `education_levels`.`id` = `education_cycles`.`education_level_id`
                            JOIN `education_level_isced` ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                            JOIN `census_students` ON `census_students`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `school_years` ON `school_years`.`id` = `census_students`.`school_year_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY
                            `areas`.`id`,
                            `census_students`.`school_year_id`,
                            `education_levels`.`id`
                        ) AS `main_data`

                        JOIN (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `education_cycles`.`education_level_id`,
                                `census_teachers`.`school_year_id` AS `year_id`,
                                SUM(`census_teachers`.`male`) + SUM(`census_teachers`.`female`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institutions` ON `institutions`.`id` = `institution_sites`.`institution_id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_programmes` ON `education_programmes`.`id` = `institution_site_programmes`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            JOIN `census_teachers` ON `census_teachers`.`institution_site_id` = `institution_sites`.`id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY
                            `areas`.`id`,
                            `census_teachers`.`school_year_id`,
                            `education_cycles`.`education_level_id`
                        ) AS `teachers`
                            ON `teachers`.`area_id` = `main_data`.`area_id`
                            AND `teachers`.`year_id` = `main_data`.`year_id`
                            AND `teachers`.`education_level_id` = `main_data`.`education_level_id`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `main_data`.`classification`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="16">
		<subgroups>
            <item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>
            <item name="All Sectors" type="Sector" order="5" reference="InstitutionSector">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `institutions`.`institution_sector_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        (SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`classes`.`total`) + IFNULL(`indicator_results`.`denominator`, 0)) AS `data_value`,
                        SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
                        SUM(`classes`.`total`) + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `education_levels`.`id` AS `education_level_id`,
                                `education_level_isced`.`name` AS `classification`,
                                `school_years`.`id` AS `year_id`,
                                `school_years`.`start_year` AS `year`,
                                SUM(`census_students`.`male`) + SUM(`census_students`.`female`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institutions` ON `institutions`.`id` = `institution_sites`.`institution_id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_programmes` ON `education_programmes`.`id` = `institution_site_programmes`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            JOIN `education_levels` ON `education_levels`.`id` = `education_cycles`.`education_level_id`
                            JOIN `education_level_isced` ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                            JOIN `census_students` ON `census_students`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `school_years` ON `school_years`.`id` = `census_students`.`school_year_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY
                            `areas`.`id`,
                            `census_students`.`school_year_id`,
                            `education_levels`.`id`
                        ) AS `main_data`

                        JOIN (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `education_cycles`.`education_level_id`,
                                `census_classes`.`school_year_id` AS `year_id`,
                                SUM(`census_classes`.`classes`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institutions` ON `institutions`.`id` = `institution_sites`.`institution_id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_programmes` ON `education_programmes`.`id` = `institution_site_programmes`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            JOIN `census_classes` ON `census_classes`.`institution_site_id` = `institution_sites`.`id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY
                            `areas`.`id`,
                            `census_classes`.`school_year_id`,
                            `education_cycles`.`education_level_id`
                        ) AS `classes`
                            ON `classes`.`area_id` = `main_data`.`area_id`
                            AND `classes`.`year_id` = `main_data`.`year_id`
                            AND `classes`.`education_level_id` = `main_data`.`education_level_id`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `main_data`.`classification`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="17">
		<subgroups>
            <item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>
            <item name="All Sectors" type="Sector" order="5" reference="InstitutionSector">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `institutions`.`institution_sector_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        (SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`teachers`.`total`) + IFNULL(`indicator_results`.`denominator`, 0)) * 100 AS `data_value`,
                        SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
                        SUM(`teachers`.`total`) + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `education_levels`.`id` AS `education_level_id`,
                                `education_level_isced`.`name` AS `classification`,
                                `school_years`.`id` AS `year_id`,
                                `school_years`.`start_year` AS `year`,
                                SUM(`census_teacher_training`.`male`) + SUM(`census_teacher_training`.`female`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institutions` ON `institutions`.`id` = `institution_sites`.`institution_id`
                            JOIN `census_teacher_training` ON `census_teacher_training`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_levels` ON `education_levels`.`id` = `census_teacher_training`.`education_level_id`
                            JOIN `education_level_isced` ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                            JOIN `school_years` ON `school_years`.`id` = `census_teacher_training`.`school_year_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY
                            `areas`.`id`,
                            `census_teacher_training`.`school_year_id`,
                            `education_levels`.`id`
                        ) AS `main_data`

                        JOIN (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `education_cycles`.`education_level_id`,
                                `census_teachers`.`school_year_id` AS `year_id`,
                                SUM(`census_teachers`.`male`) + SUM(`census_teachers`.`female`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institutions` ON `institutions`.`id` = `institution_sites`.`institution_id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_programmes` ON `education_programmes`.`id` = `institution_site_programmes`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            JOIN `census_teachers` ON `census_teachers`.`institution_site_id` = `institution_sites`.`id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY
                            `areas`.`id`,
                            `census_teachers`.`school_year_id`,
                            `education_cycles`.`education_level_id`
                        ) AS `teachers`
                            ON `teachers`.`area_id` = `main_data`.`area_id`
                            AND `teachers`.`year_id` = `main_data`.`year_id`
                            AND `teachers`.`education_level_id` = `main_data`.`education_level_id`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `main_data`.`classification`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="18">
		<subgroups>
            <item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>
            <item name="All Sectors" type="Sector" order="5" reference="InstitutionSector">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `institutions`.`institution_sector_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        (SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`denominator`, 0)) AS `data_value`,
                        SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
                        SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `school_years`.`name` AS `year`,
                                `education_level_isced`.`name` AS `classification`,
                                SUM(`census_students`.`female`) AS `female`,
                                SUM(`census_students`.`male`) AS `male`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institutions` ON `institutions`.`id` = `institution_sites`.`institution_id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_programmes` ON `education_programmes`.`id` = `institution_site_programmes`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            JOIN `education_levels` ON `education_levels`.`id` = `education_cycles`.`education_level_id`
                            JOIN `education_level_isced` ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                            JOIN `census_students` ON `census_students`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `school_years` ON `school_years`.`id` = `census_students`.`school_year_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY
                            `areas`.`id`,
                            `census_students`.`school_year_id`,
                            `education_levels`.`id`
                        ) AS `main_data`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `main_data`.`classification`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="19">
		<subgroups>
            <item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>
            <item name="All Sectors" type="Sector" order="5" reference="InstitutionSector">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `institutions`.`institution_sector_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        (SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`denominator`, 0)) * 100 AS `data_value`,
                        SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
                        SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `school_years`.`start_year` AS `year`,
                                `education_level_isced`.`name` AS `classification`,
                                SUM(`census_students`.`female`) AS `female`,
                                SUM(`census_students`.`male`) + SUM(`census_students`.`female`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institutions` ON `institutions`.`id` = `institution_sites`.`institution_id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_programmes` ON `education_programmes`.`id` = `institution_site_programmes`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            JOIN `education_levels` ON `education_levels`.`id` = `education_cycles`.`education_level_id`
                            JOIN `education_level_isced` ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                            JOIN `census_students` ON `census_students`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `school_years` ON `school_years`.`id` = `census_students`.`school_year_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY
                            `areas`.`id`,
                            `census_students`.`school_year_id`,
                            `education_levels`.`id`
                        ) AS `main_data`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `main_data`.`classification`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="20">
		<subgroups>
            <item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>
            <item name="All Sectors" type="Sector" order="5" reference="InstitutionSector">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `institutions`.`institution_sector_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        (SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`denominator`, 0)) * 100 AS `data_value`,
                        SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
                        SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `school_years`.`start_year` AS `year`,
                                `education_level_isced`.`name` AS `classification`,
                                SUM(`census_teachers`.`female`) AS `female`,
                                SUM(`census_teachers`.`male`) + SUM(`census_teachers`.`female`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institutions` ON `institutions`.`id` = `institution_sites`.`institution_id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_programmes` ON `education_programmes`.`id` = `institution_site_programmes`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            JOIN `education_levels` ON `education_levels`.`id` = `education_cycles`.`education_level_id`
                            JOIN `education_level_isced` ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                            JOIN `census_teachers` ON `census_teachers`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `school_years` ON `school_years`.`id` = `census_teachers`.`school_year_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY
                            `areas`.`id`,
                            `census_teachers`.`school_year_id`,
                            `education_levels`.`id`
                        ) AS `main_data`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `main_data`.`classification`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="21">
		<subgroups>
			<item name="All Sex" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            (SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`total_enrolment`.`total`) + IFNULL(`indicator_results`.`denominator`, 0)) * 100 AS `data_value`,
SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
SUM(`total_enrolment`.`total`) + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Male" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            (SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`total_enrolment`.`male`) + IFNULL(`indicator_results`.`denominator`, 0)) * 100 AS `data_value`,
SUM(`main_data`.`male`) + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
SUM(`total_enrolment`.`male`) + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Female" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            (SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`total_enrolment`.`female`) + IFNULL(`indicator_results`.`denominator`, 0)) * 100 AS `data_value`,
SUM(`main_data`.`female`) + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
SUM(`total_enrolment`.`female`) + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
					]]>
					</select>
				</mysql>
			</item>
            <item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        -- {SELECT}
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `school_years`.`id` AS `year_id`,
                                `school_years`.`start_year` AS `year`,
                                `education_levels`.`id` AS `education_level_id`,
                                `education_level_isced`.`name` AS `classification`,
                                SUM(`census_students`.`male`) AS `male`,
                                SUM(`census_students`.`female`) AS `female`,
                                SUM(`census_students`.`male`) + SUM(`census_students`.`female`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institutions` ON `institutions`.`id` = `institution_sites`.`institution_id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_programmes` ON `education_programmes`.`id` = `institution_site_programmes`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            JOIN `education_levels` ON `education_levels`.`id` = `education_cycles`.`education_level_id`
                            JOIN `education_level_isced` ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                            JOIN `census_students` ON `census_students`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `school_years` ON `school_years`.`id` = `census_students`.`school_year_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            AND `institutions`.`institution_sector_id` = 2 -- PRIVATE
                            -- {WHERE}
                            GROUP BY
                            `areas`.`id`,
                            `census_students`.`school_year_id`,
                            `education_levels`.`id`
                        ) AS `main_data`

                        JOIN (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `education_cycles`.`education_level_id`,
                                `census_students`.`school_year_id` AS `year_id`,
                                SUM(`census_students`.`male`) AS `male`,
                                SUM(`census_students`.`female`) AS `female`,
                                SUM(`census_students`.`male`) + SUM(`census_students`.`female`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institutions` ON `institutions`.`id` = `institution_sites`.`institution_id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_programmes` ON `education_programmes`.`id` = `institution_site_programmes`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            JOIN `census_students` ON `census_students`.`institution_site_id` = `institution_sites`.`id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY
                            `areas`.`id`,
                            `census_students`.`school_year_id`,
                            `education_cycles`.`education_level_id`
                        ) AS `total_enrolment`
                            ON `total_enrolment`.`area_id` = `main_data`.`area_id`
                            AND `total_enrolment`.`year_id` = `main_data`.`year_id`
                            AND `total_enrolment`.`education_level_id` = `main_data`.`education_level_id`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `main_data`.`classification`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="22">
		<subgroups>
            <item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>
            <item name="All Sectors" type="Sector" order="5" reference="InstitutionSector">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `institutions`.`institution_sector_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        (SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0)) / (SUM(`textbooks`.`total`) + IFNULL(`indicator_results`.`denominator`, 0)) AS `data_value`,
                        SUM(`main_data`.`total`) + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
                        SUM(`textbooks`.`total`) + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `education_levels`.`id` AS `education_level_id`,
                                `education_level_isced`.`name` AS `classification`,
                                `school_years`.`id` AS `year_id`,
                                `school_years`.`start_year` AS `year`,
                                SUM(`census_students`.`male`) + SUM(`census_students`.`female`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institutions` ON `institutions`.`id` = `institution_sites`.`institution_id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_programmes` ON `education_programmes`.`id` = `institution_site_programmes`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            JOIN `education_levels` ON `education_levels`.`id` = `education_cycles`.`education_level_id`
                            JOIN `education_level_isced` ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                            JOIN `census_students` ON `census_students`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `school_years` ON `school_years`.`id` = `census_students`.`school_year_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY
                            `areas`.`id`,
                            `census_students`.`school_year_id`,
                            `education_levels`.`id`
                        ) AS `main_data`

                        JOIN (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `education_cycles`.`education_level_id`,
                                `census_textbooks`.`school_year_id` AS `year_id`,
                                SUM(`census_textbooks`.`value`) AS `total`
                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institutions` ON `institutions`.`id` = `institution_sites`.`institution_id`
                            JOIN `institution_site_programmes` ON `institution_site_programmes`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `education_programmes` ON `education_programmes`.`id` = `institution_site_programmes`.`education_programme_id`
                            JOIN `education_cycles` ON `education_cycles`.`id` = `education_programmes`.`education_cycle_id`
                            JOIN `census_textbooks` ON `census_textbooks`.`institution_site_id` = `institution_sites`.`id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY
                            `areas`.`id`,
                            `census_textbooks`.`school_year_id`,
                            `education_cycles`.`education_level_id`
                        ) AS `textbooks`
                            ON `textbooks`.`area_id` = `main_data`.`area_id`
                            AND `textbooks`.`year_id` = `main_data`.`year_id`
                            AND `textbooks`.`education_level_id` = `main_data`.`education_level_id`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End

                        GROUP BY
                        `main_data`.`year`,
                        `main_data`.`area_id`,
                        `main_data`.`classification`
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="23">
		<subgroups>
            <item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>
            <item name="All Sectors" type="Sector" order="5" reference="InstitutionSector">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `institutions`.`institution_sector_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>
            <item name="All Conditions" type="Infrastructure Condition" order="6" reference="InfrastructureWater">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `infrastructure_statuses`.`id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        IFNULL(`main_data`.`numerator` + IFNULL(`indicator_results`.`numerator`, 0), 'No Data') AS `data_value`,
                        `main_data`.`numerator` + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
                        NULL,
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                            `areas`.`id` AS `area_id`,
                            `school_years`.`start_year` AS `year`,
                            SUM(`census_water`.`value`) AS `numerator`,
                            CONCAT('Infrastructure - Water - ', `infrastructure_water`.`name`) AS `classification`

                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institutions` ON `institutions`.`id` = `institution_sites`.`institution_id`
                            JOIN `census_water` ON `census_water`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `school_years` ON `school_years`.`id` = `census_water`.`school_year_id`
                            JOIN `infrastructure_water` ON `infrastructure_water`.`id` = `census_water`.`infrastructure_water_id`
                            JOIN `infrastructure_statuses` ON `infrastructure_statuses`.`id` = `census_water`.`infrastructure_status_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY
                            `areas`.`id`,
                            `census_water`.`school_year_id`,
                            `infrastructure_water`.`id`
                        ) AS `main_data`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
	<indicator id="24">
		<subgroups>
			<item name="All Sex" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            IFNULL(`main_data`.`total` + IFNULL(`indicator_results`.`numerator`, 0), 'No Data') AS `data_value`,
`main_data`.`total` + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Male" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            IFNULL(`main_data`.`male` + IFNULL(`indicator_results`.`numerator`, 0), 'No Data') AS `data_value`,
`main_data`.`male` + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Female" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            IFNULL(`main_data`.`female` + IFNULL(`indicator_results`.`numerator`, 0), 'No Data') AS `data_value`,
`main_data`.`female` + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
					]]>
					</select>
				</mysql>
			</item>
			<item name="Unisex" type="Sex" order="2">
				<mysql>
					<select>
					<![CDATA[
                            IFNULL(`main_data`.`unisex` + IFNULL(`indicator_results`.`numerator`, 0), 'No Data') AS `data_value`,
`main_data`.`unisex` + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
					]]>
					</select>
				</mysql>
			</item>
            <item name="All Localities" type="Locality" order="3" reference="InstitutionSiteLocality">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `institution_sites`.`institution_site_locality_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>
            <item name="All Sectors" type="Sector" order="5" reference="InstitutionSector">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `institutions`.`institution_sector_id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>
            <item name="All Conditions" type="Infrastructure Condition" order="6" reference="InfrastructureSanitation">
                <mysql>
                    <where>
                        <![CDATA[
                                AND `infrastructure_statuses`.`id` = {KEY}
						]]>
                    </where>
                </mysql>
            </item>

		</subgroups>
		<query>
			<mysql>
				<insert>
				<![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        -- {SELECT}
                        NULL,
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                            `areas`.`id` AS `area_id`,
                            `school_years`.`start_year` AS `year`,
                            SUM(`census_sanitations`.`male`) AS `male`,
                            SUM(`census_sanitations`.`female`) AS `female`,
                            SUM(`census_sanitations`.`unisex`) AS `unisex`,
                            SUM(`census_sanitations`.`male`) + SUM(`census_sanitations`.`female`) + SUM(`census_sanitations`.`unisex`) AS `total`,
                            CONCAT('Infrastructure - Sanitation - ', `infrastructure_sanitations`.`name`, ' - ', `infrastructure_materials`.`name`) AS `classification`

                            FROM `areas`
                            JOIN `institution_sites` ON `institution_sites`.`area_id` = `areas`.`id`
                            JOIN `institutions` ON `institutions`.`id` = `institution_sites`.`institution_id`
                            JOIN `census_sanitations` ON `census_sanitations`.`institution_site_id` = `institution_sites`.`id`
                            JOIN `school_years` ON `school_years`.`id` = `census_sanitations`.`school_year_id`
                            JOIN `infrastructure_sanitations` ON `infrastructure_sanitations`.`id` = `census_sanitations`.`infrastructure_sanitation_id`
                            JOIN `infrastructure_materials` ON `infrastructure_materials`.`id` = `census_sanitations`.`infrastructure_material_id`
                            JOIN `infrastructure_statuses` ON `infrastructure_statuses`.`id` = `census_sanitations`.`infrastructure_status_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                            -- {WHERE}
                            GROUP BY
                            `areas`.`id`,
                            `census_sanitations`.`school_year_id`,
                            `infrastructure_sanitations`.`id`,
                            `infrastructure_materials`.`id`
                        ) AS `main_data`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End
				]]>
				</insert>
			</mysql>
		</query>

	</indicator>
    <indicator id="25">
        <subgroups>
            <item name="National Level Indicator" type="National" order="2">
                <mysql>
                    <select>
                        <![CDATA[
                            IFNULL(ROUND(`main_data`.`numerator` / `main_data`.`denominator` * 100, 2), 'No Data') AS `data_value`,
`main_data`.`numerator` + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
`main_data`.`denominator` + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
					]]>
                    </select>
                </mysql>
            </item>

        </subgroups>
        <query>
            <mysql>
                <insert>
                    <![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        -- {SELECT}
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `public_expenditure_education_level`.`year`,
                                `public_expenditure_education_level`.`value` AS `numerator`,
                                `public_expenditure`.`total_public_expenditure_education` AS `denominator`,
                                CONCAT('Finances - ', `education_level_isced`.`name`) AS `classification`
                            FROM `areas`
                            JOIN `public_expenditure_education_level` ON `public_expenditure_education_level`.`area_id` = `areas`.`id`
                            JOIN `public_expenditure`
                                ON `public_expenditure`.`area_id` = `public_expenditure_education_level`.`area_id`
                                AND `public_expenditure`.`year` = `public_expenditure_education_level`.`year`
                            JOIN `education_levels` ON `education_levels`.`id` = `public_expenditure_education_level`.`education_level_id`
                            JOIN `education_level_isced` ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                        ) AS `main_data`

                        -- Aggregation by Area Start
                        LEFT JOIN (
                            SELECT
                            `areas`.`parent_id` AS `area_parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                            SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                            `batch_indicator_results`.`classification`
                            FROM `batch_indicator_results`
                            JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                            WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                            AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                            GROUP BY
                            `areas`.`parent_id`,
                            `batch_indicator_results`.`timeperiod`,
                            `batch_indicator_results`.`classification`
                        ) AS `indicator_results`
                            ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                            AND `indicator_results`.`timeperiod` = `main_data`.`year`
                            AND `indicator_results`.`classification` = `main_data`.`classification`
                        -- Aggregation by Area End
				]]>
                </insert>
            </mysql>
        </query>

    </indicator>
    <indicator id="26">
        <subgroups>
            <item name="National Level Indicator" type="National" order="2">
                <mysql>
                    <select>
                        <![CDATA[
					]]>
                    </select>
                </mysql>
            </item>

        </subgroups>
        <query>
            <mysql>
                <insert>
                    <![CDATA[
                            INSERT INTO `batch_indicator_results`
                            SELECT
                            NULL,
                            -- {INDICATOR_ID} AS `batch_indicator_id`,
                            -- {SUBGROUPS} AS `subgroups`,
                            `main_data`.`area_id`,
                            `main_data`.`year` AS `timeperiod`,
                            ROUND((`main_data`.`numerator` + IFNULL(`indicator_results`.`numerator`, 0)) / (`main_data`.`denominator` + IFNULL(`indicator_results`.`denominator`, 0)) * 100, 2) AS `data_value`,
                            `main_data`.`numerator` + IFNULL(`indicator_results`.`numerator`, 0) AS `numerator`,
                            `main_data`.`denominator` + IFNULL(`indicator_results`.`denominator`, 0) AS `denominator`,
                            `main_data`.`classification`,
                            -- {USER_ID},
                            NOW()

                            FROM (
                                SELECT
                                    `areas`.`id` AS `area_id`,
                                    `public_expenditure`.`year`,
                                    `public_expenditure`.`total_public_expenditure_education` AS `numerator`,
                                    `public_expenditure`.`total_public_expenditure` AS `denominator`,
                                    CONCAT('Finances') AS `classification`
                                FROM `areas`
                                JOIN `public_expenditure` ON `public_expenditure`.`area_id` = `areas`.`id`
                                WHERE `areas`.`area_level_id` = -- {LEVEL}
                            ) AS `main_data`

                            -- Aggregation by Area Start
                            LEFT JOIN (
                                SELECT
                                `areas`.`parent_id` AS `area_parent_id`,
                                `batch_indicator_results`.`timeperiod`,
                                SUM(`batch_indicator_results`.`numerator`) AS `numerator`,
                                SUM(`batch_indicator_results`.`denominator`) AS `denominator`,
                                `batch_indicator_results`.`classification`
                                FROM `batch_indicator_results`
                                JOIN `areas` ON `areas`.`id` = `batch_indicator_results`.`area_id`
                                WHERE `batch_indicator_results`.`batch_indicator_id` = -- {INDICATOR_ID}
                                AND `batch_indicator_results`.`subgroups` = -- {SUBGROUPS}
                                GROUP BY
                                `areas`.`parent_id`,
                                `batch_indicator_results`.`timeperiod`,
                                `batch_indicator_results`.`classification`
                            ) AS `indicator_results`
                                ON `indicator_results`.`area_parent_id` = `main_data`.`area_id`
                                AND `indicator_results`.`timeperiod` = `main_data`.`year`
                                AND `indicator_results`.`classification` = `main_data`.`classification`
                            -- Aggregation by Area End

                            GROUP BY
                            `main_data`.`year`,
                            `main_data`.`area_id`,
                            `main_data`.`classification`
				]]>
                </insert>
            </mysql>
        </query>

    </indicator>
    <indicator id="27">
        <subgroups>
            <item name="National Level Indicator" type="National" order="2">
                <mysql>
                    <select>
                        <![CDATA[
					]]>
                    </select>
                </mysql>
            </item>

        </subgroups>
        <query>
            <mysql>
                <insert>
                    <![CDATA[
                            INSERT INTO `batch_indicator_results`
                            SELECT
                            NULL,
                            -- {INDICATOR_ID} AS `batch_indicator_id`,
                            -- {SUBGROUPS} AS `subgroups`,
                            `main_data`.`area_id`,
                            `main_data`.`year` AS `timeperiod`,
                            ROUND(`main_data`.`numerator` / `main_data`.`denominator` * 100, 2) AS `data_value`,
                            `main_data`.`numerator` AS `numerator`,
                            `main_data`.`denominator` AS `denominator`,
                            `main_data`.`classification`,
                            -- {USER_ID},
                            NOW()

                            FROM (
                                SELECT
                                    `areas`.`id` AS `area_id`,
                                    `public_expenditure`.`year`,
                                    `public_expenditure`.`total_public_expenditure_education` AS `numerator`,
                                    `public_expenditure`.`gross_national_product` AS `denominator`,
                                    CONCAT('Finances') AS `classification`
                                FROM `areas`
                                JOIN `public_expenditure` ON `public_expenditure`.`area_id` = `areas`.`id`
                                WHERE `areas`.`parent_id` = -1
                            ) AS `main_data`
				]]>
                </insert>
            </mysql>
        </query>

    </indicator>
    <indicator id="28">
        <subgroups>
            <item name="National Level Indicator" type="National" order="2">
                <mysql>
                    <select>
                        <![CDATA[
					]]>
                    </select>
                </mysql>
            </item>

        </subgroups>
        <query>
            <mysql>
                <insert>
                    <![CDATA[
                            INSERT INTO `batch_indicator_results`
                            SELECT
                            NULL,
                            -- {INDICATOR_ID} AS `batch_indicator_id`,
                            -- {SUBGROUPS} AS `subgroups`,
                            `main_data`.`area_id`,
                            `main_data`.`year` AS `timeperiod`,
                            `main_data`.`numerator` / `main_data_b`.`denominator` * 100 AS `data_value`,
                            `main_data`.`numerator` AS `numerator`,
                            `main_data_b`.`denominator` AS `denominator`,
                            `main_data`.`classification`,
                            -- {USER_ID},
                            NOW()

                            FROM (
                                SELECT
                                    `areas`.`id` AS `area_id`,
                                    `public_expenditure_education_level`.`year`,
                                    `public_expenditure_education_level`.`value` / SUM(`census_students`.`male` + `census_students`.`female`) AS `numerator`,
                                    CONCAT('Finances - ', `education_level_isced`.`name`) AS `classification`
                                FROM `areas`
                                JOIN `public_expenditure_education_level` ON `public_expenditure_education_level`.`area_id` = `areas`.`id`
                                JOIN `school_years` ON `school_years`.`name` = `public_expenditure_education_level`.`year`
                                JOIN `education_levels` ON `education_levels`.`id` = `public_expenditure_education_level`.`education_level_id`
                                JOIN `education_level_isced` ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                                JOIN `education_cycles` ON `education_cycles`.`education_level_id` = `education_levels`.`id`
                                JOIN `education_programmes` ON `education_programmes`.`education_cycle_id` = `education_cycles`.`id`
                                JOIN `education_grades` ON `education_grades`.`education_programme_id` = `education_programmes`.`id`
                                JOIN `census_students`
                                    ON `census_students`.`education_grade_id` = `education_grades`.`id`
                                    AND `census_students`.`school_year_id` = `school_years`.`id`
                                WHERE `areas`.`parent_id` = -1
                                GROUP BY `education_levels`.`id`, `school_years`.`id`
                                ORDER BY `education_level_isced`.`isced_level`
                            ) AS `main_data`

                            JOIN (
                                SELECT
                                    `areas`.`id` AS `area_id`,
                                    `public_expenditure`.`year`,
                                    `public_expenditure`.`gross_national_product` / SUM(`population`.`male` + `population`.`female`) AS `denominator`
                                FROM `areas`
                                JOIN `public_expenditure` ON `public_expenditure`.`area_id` = `areas`.`id`
                                JOIN `population`
                                    ON `population`.`area_id` = `areas`.`id`
                                    AND `population`.`year` = `public_expenditure`.`year`
                                WHERE `areas`.`parent_id` = -1
                                GROUP BY `areas`.`id`, `population`.`year`
                            ) AS `main_data_b`
                                ON `main_data_b`.`area_id` = `main_data`.`area_id`
                                AND `main_data_b`.`year` = `main_data`.`year`

                            GROUP BY
                            `main_data`.`area_id`,
                            `main_data`.`year`,
                            `main_data`.`classification`
				]]>
                </insert>
            </mysql>
        </query>

    </indicator>
</indicators>