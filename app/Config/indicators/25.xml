<indicators>
    <indicator id="25">
        <subgroups>
            <item name="National Level Indicator" type="National" order="2">
                <mysql>
                    <select>
                        <![CDATA[
                        ROUND(`main_data`.`numerator` / `main_data`.`denominator` * 100, 2) AS `data_value`,
						`main_data`.`numerator`,
						`main_data`.`denominator`,
					]]>
                    </select>
                </mysql>
            </item>

        </subgroups>
        <query>
            <mysql>
                <insert>
                    <![CDATA[
                        INSERT INTO `batch_indicator_results`
                        SELECT
                        NULL,
                        -- {INDICATOR_ID} AS `batch_indicator_id`,
                        -- {SUBGROUPS} AS `subgroups`,
                        `main_data`.`area_id`,
                        `main_data`.`year` AS `timeperiod`,
                        -- {SELECT}
                        `main_data`.`classification`,
                        -- {USER_ID},
                        NOW()

                        FROM (
                            SELECT
                                `areas`.`id` AS `area_id`,
                                `public_expenditure_education_level`.`year`,
                                `public_expenditure_education_level`.`value` AS `numerator`,
                                `public_expenditure`.`total_public_expenditure_education` AS `denominator`,
                                CONCAT('Finances - ', `education_level_isced`.`name`) AS `classification`
                            FROM `areas`
                            JOIN `public_expenditure_education_level` ON `public_expenditure_education_level`.`area_id` = `areas`.`id`
                            JOIN `public_expenditure`
                                ON `public_expenditure`.`area_id` = `public_expenditure_education_level`.`area_id`
                                AND `public_expenditure`.`year` = `public_expenditure_education_level`.`year`
                            JOIN `education_levels` ON `education_levels`.`id` = `public_expenditure_education_level`.`education_level_id`
                            JOIN `education_level_isced` ON `education_level_isced`.`id` = `education_levels`.`education_level_isced_id`
                            WHERE `areas`.`area_level_id` = -- {LEVEL}
                        ) AS `main_data`
				]]>
                </insert>
            </mysql>
        </query>

    </indicator>

</indicators>