Update batch_reports set query='$this->autoRender = false;\n        $TrainingCourse = ClassRegistry::init(''TrainingCourse'');\n        $TrainingCourse->formatResult = true;\n        $data = $TrainingCourse->find(''all'', \n        array(''fields'' => array(\n            ''TrainingCourse.code as CourseCode'', ''TrainingCourse.title as CourseTitle'', ''StaffPositionTitle.name as TargetGroup'', ''COUNT(DISTINCT IFNULL(InstitutionSiteStaff.staff_id, Staff.id)) as TotalTargetGroup'', ''COUNT(DISTINCT TrainingSessionTrainee.staff_id) as TotalTrained'',\n            ''round(((COUNT(DISTINCT TrainingSessionTrainee.staff_id)/IFNULL(COUNT(DISTINCT IFNULL(InstitutionSiteStaff.staff_id, Staff.id)),0)) * 100),2)  as TargetGroupPercentage''\n        ),\n        ''joins'' => array(\n            array(\n                ''table'' => ''training_sessions'',''alias'' => ''TrainingSession'',''type'' => ''INNER'',\n                ''conditions'' => array(''TrainingCourse.id = TrainingSession.training_course_id'', ''TrainingSession.training_status_id''=>3)\n            ),\n            array(\n                ''table'' => ''training_session_trainees'',''alias'' => ''TrainingSessionTrainee'',''type'' => ''LEFT'',\n                ''conditions'' => array(''TrainingSession.id = TrainingSessionTrainee.training_session_id'')\n            ), \n            array(\n                ''table'' => ''training_course_target_populations'',''alias'' => ''TrainingCourseTargetPopulation'',''type'' => ''LEFT'',\n                ''conditions'' => array(''TrainingCourse.id = TrainingCourseTargetPopulation.training_course_id'')\n            ),\n             array(\n                ''table'' => ''institution_site_staff'',''alias'' => ''InstitutionSiteStaff'',''type'' => ''LEFT'',\n                ''conditions'' => array(''TrainingSessionTrainee.staff_id = InstitutionSiteStaff.staff_id'')\n            ),  \n            array(\n                ''table'' => ''institution_site_positions'',''alias'' => ''InstitutionSitePosition'',''type'' => ''LEFT'',\n                ''conditions'' => array(''InstitutionSiteStaff.institution_site_position_id = InstitutionSitePosition.id'', ''TrainingCourseTargetPopulation.staff_position_title_id = InstitutionSitePosition.staff_position_title_id'')\n            ), \n            array(\n                ''table'' => ''staff_position_titles'',''alias'' => ''StaffPositionTitle'',''type'' => ''LEFT'',\n                ''conditions'' => array(''StaffPositionTitle.id = InstitutionSitePosition.staff_position_title_id'')\n            ), \n            array(\n                ''table'' => ''staff'',''alias'' => ''Staff'',''type'' => ''LEFT'',\n                ''conditions'' => array(''Staff.id IS NOT NULL'')\n            ),\n            array(\n                ''table'' => ''training_session_results'',''alias'' => ''TrainingSessionResult'',''type'' => ''LEFT'',\n                ''conditions'' => array(''TrainingSession.id = TrainingSessionResult.training_session_id'', ''TrainingSessionResult.training_status_id''=>3)\n            ),\n         ),\n         ''conditions'' => array(''TrainingCourse.training_status_id''=>3),\n         ''group'' => array(''TrainingCourse.id'', ''TrainingCourseTargetPopulation.staff_position_title_id''),\n         ''order'' => array(''TrainingCourse.title'')\n        ));',
template='CourseCode,CourseTitle,TargetGroup,TotalTargetGroup,TotalTrained,TargetGroupPercentage'
where id = 1035;
